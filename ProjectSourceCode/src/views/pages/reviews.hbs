{{> head}}

<!-- Table that displays book review information for a user -->
<div class="container">
  <h2>Book Reviews</h2>

  <table class="table">
    <thead>
      <tr>
        <th>Book Name</th>
        <th>Rating</th>
      </tr>
    </thead>
    <tbody>
      {{#each reviews}}
        <tr>
          <td>{{book_name}}</td>
          <td>{{rating}}</td>
          <td>
            <form action="/reviews/add" method="POST">
              <input type="hidden" name="review_id" value="{{review_id}}">
              {{#if taken}}
                <button type="submit" class="btn btn-secondary" disabled>Added</button>
              {{else}}
                <button type="submit" class="btn btn-primary">Add</button>
              {{/if}}
            </form>
          </td>
        </tr>
        
        <!-- Comments Section -->
        <tr>
          <td colspan="5">
            <h5>Comments:</h5>
            <ul>
              {{#each comments}}
                <li>
                  <strong>{{username}}:</strong> {{comment}} <small>({{created_at}})</small>
                </li>
              {{/each}}
            </ul>

            <!-- Add Comment Form -->
            <form action="/reviews/{{review_id}}/comment" method="POST">
              <div class="form-group">
                <textarea class="form-control" name="comment" rows="3" placeholder="Add a comment..." required></textarea>
              </div>
              <button type="submit" class="btn btn-success">Submit Comment</button>
            </form>
          </td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</div>

{{> footer}}